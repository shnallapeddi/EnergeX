Last login: Wed Sep  3 21:24:57 on ttys002
eval "$(/opt/homebrew/bin/brew shellenv)"
(base) sharanya@Mac ~ % mkdir -p ~/code/energex && cd ~/code/energex
(base) sharanya@Mac energex % cd php-api
(base) sharanya@Mac php-api % redis-cli keys 'posts*'
1) "posts:1"
2) "posts:all"
(base) sharanya@Mac php-api % redis-cli TYPE posts:all
string
(base) sharanya@Mac php-api % redis-cli STRLEN posts:all
(integer) 197
(base) sharanya@Mac php-api % redis-cli TTL posts:all
(integer) -1
(base) sharanya@Mac php-api % nano .env
(base) sharanya@Mac php-api % mysql -u energex_user -p -h 127.0.0.1 -P 3306 -e "SHOW DATABASES LIKE 'energex_test';"
Enter password: 
+-------------------------+
| Database (energex_test) |
+-------------------------+
| energex_test            |
+-------------------------+
(base) sharanya@Mac php-api % mkdir -p database/migrations
(base) sharanya@Mac php-api % nano database/migrations/2025_09_04_000000_create_users_table.php
(base) sharanya@Mac php-api % nano database/migrations/2025_09_04_000001_create_posts_table.php
(base) sharanya@Mac php-api % nano database/migrations/2025_09_04_000001_create_posts_table.php
(base) sharanya@Mac php-api % ls -1 database/migrations
2025_09_03_201253_create_users_table.php
2025_09_03_201454_create_posts_table.php
2025_09_04_000000_create_users_table.php
2025_09_04_000001_create_posts_table.php
(base) sharanya@Mac php-api % php artisan migrate:status

  Migration name ........................................................... Batch / Status  
  2025_09_03_201253_create_users_table ............................................ [1] Ran  
  2025_09_03_201454_create_posts_table ............................................ [1] Ran  
  2025_09_04_000000_create_users_table ............................................ Pending  
  2025_09_04_000001_create_posts_table ............................................ Pending  

(base) sharanya@Mac php-api % php artisan migrate 

   INFO  Running migrations.  

  2025_09_04_000000_create_users_table ........................................... 8ms FAIL

In Connection.php line 829:
                                                                                            
  SQLSTATE[42S01]: Base table or view already exists: 1050 Table 'users' already exists (C  
  onnection: mysql, SQL: create table `users` (`id` bigint unsigned not null auto_incremen  
  t primary key, `name` varchar(255) not null, `email` varchar(255) not null, `password` v  
  archar(255) not null, `created_at` timestamp null, `updated_at` timestamp null) default   
  character set utf8mb4 collate 'utf8mb4_unicode_ci')                                       
                                                                                            

In Connection.php line 587:
                                                                                         
  SQLSTATE[42S01]: Base table or view already exists: 1050 Table 'users' already exists  
                                                                                         

(base) sharanya@Mac php-api % rm database/migrations/2025_09_04_000000_create_users_table.php \ 
   database/migrations/2025_09_04_000001_create_posts_table.php
(base) sharanya@Mac php-api % php artisan migrate:status

  Migration name ............................................................. Batch / Status  
  2025_09_03_201253_create_users_table .............................................. [1] Ran  
  2025_09_03_201454_create_posts_table .............................................. [1] Ran  

(base) sharanya@Mac php-api % mysql -u energex_user -p -h 127.0.0.1 -P 3306 -D energex_test
Enter password: 
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 42
Server version: 9.1.0 MySQL Community Server - GPL

Copyright (c) 2000, 2024, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> SHOW TABLES;
+------------------------+
| Tables_in_energex_test |
+------------------------+
| migrations             |
| posts                  |
| users                  |
+------------------------+
3 rows in set (0.00 sec)

mysql> DESCRIBE users;
+------------+-----------------+------+-----+---------+----------------+
| Field      | Type            | Null | Key | Default | Extra          |
+------------+-----------------+------+-----+---------+----------------+
| id         | bigint unsigned | NO   | PRI | NULL    | auto_increment |
| name       | varchar(255)    | NO   |     | NULL    |                |
| email      | varchar(191)    | NO   | UNI | NULL    |                |
| password   | varchar(191)    | NO   |     | NULL    |                |
| created_at | timestamp       | YES  |     | NULL    |                |
| updated_at | timestamp       | YES  |     | NULL    |                |
+------------+-----------------+------+-----+---------+----------------+
6 rows in set (0.03 sec)

mysql> DESCRIBE posts;
+------------+-----------------+------+-----+---------+----------------+
| Field      | Type            | Null | Key | Default | Extra          |
+------------+-----------------+------+-----+---------+----------------+
| id         | bigint unsigned | NO   | PRI | NULL    | auto_increment |
| title      | varchar(200)    | NO   |     | NULL    |                |
| content    | text            | NO   |     | NULL    |                |
| user_id    | bigint unsigned | YES  | MUL | NULL    |                |
| created_at | timestamp       | YES  |     | NULL    |                |
| updated_at | timestamp       | YES  |     | NULL    |                |
+------------+-----------------+------+-----+---------+----------------+
6 rows in set (0.01 sec)

mysql> SHOW CREATE TABLE posts\G
*************************** 1. row ***************************
       Table: posts
Create Table: CREATE TABLE `posts` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(200) COLLATE utf8mb4_unicode_ci NOT NULL,
  `content` text COLLATE utf8mb4_unicode_ci NOT NULL,
  `user_id` bigint unsigned DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `posts_user_id_foreign` (`user_id`),
  CONSTRAINT `posts_user_id_foreign` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE SET NULL
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
1 row in set (0.01 sec)

mysql> CREATE INDEX posts_user_id_idx ON posts (user_id);
Query OK, 0 rows affected (0.07 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> CREATE INDEX posts_created_at_idx ON posts (created_at);
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE posts 
    ->   MODIFY created_at timestamp NULL DEFAULT CURRENT_TIMESTAMP,
    ->   MODIFY updated_at timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> INSERT INTO users (name,email,password,created_at,updated_at)
    -> VALUES ('Testy','test@example.com','$2y$12$fakeBcryptHashHere',NOW(),NOW());
Query OK, 1 row affected (0.02 sec)

mysql> INSERT INTO posts (title,content,user_id,created_at,updated_at)
    -> VALUES ('Hello','From SQL', LAST_INSERT_ID(), NOW(), NOW());
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM posts ORDER BY id DESC LIMIT 1;
+----+-------+----------+---------+---------------------+---------------------+
| id | title | content  | user_id | created_at          | updated_at          |
+----+-------+----------+---------+---------------------+---------------------+
|  2 | Hello | From SQL |       2 | 2025-09-03 23:31:13 | 2025-09-03 23:31:13 |
+----+-------+----------+---------+---------------------+---------------------+
1 row in set (0.01 sec)

mysql> DELETE FROM users WHERE email='test@example.com';
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM posts WHERE title='Hello';
+----+-------+----------+---------+---------------------+---------------------+
| id | title | content  | user_id | created_at          | updated_at          |
+----+-------+----------+---------+---------------------+---------------------+
|  2 | Hello | From SQL |    NULL | 2025-09-03 23:31:13 | 2025-09-03 23:31:13 |
+----+-------+----------+---------+---------------------+---------------------+
1 row in set (0.00 sec)

mysql> 
